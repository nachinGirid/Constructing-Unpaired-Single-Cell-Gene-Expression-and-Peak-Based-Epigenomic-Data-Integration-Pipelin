## MOSCOT-based label transfer 

This script does cross-modality label transfer using optimal transport
implemented in **MOSCOT**. RNA cell-type labels are transferred to ATAC cells
based on a shared embedding space produced by an integration method.

### Method setting

- Dimension reduction method: **Seurat**
- Gene activity method: **Signac**
- Embedding dimension: **15**

These are used as example defaults and can be changed by editing the variables
at the top of the script.

### Required inputs

The script assumes the following inputs are already prepared:

1. **Joint embeddings**
   - `rna_em.csv`
   - `atac_em.csv`

   Stored under a method-specific folder structure, for example:

processed_embeddings/
seurat/
pbmc/
signac/
dim15/
rna_em.csv
atac_em.csv  

2. **RNA cell-type labels and barcodes**
Located in the processed data directory:

- `seurat_RNA_label.txt` (or `.csv`)
- `barcodes.tsv`

3. **Original AnnData objects**
- `rna_fil_rowsum0.h5ad`
- `atac_fil_rowsum0.h5ad`

### What the script does

1. Loads RNA and ATAC embeddings generated by an integration method.
2. Aligns embeddings with shared cell barcodes.
3. Constructs a MOSCOT `TranslationProblem` using the joint embedding.
4. Solves an optimal transport problem between RNA and ATAC cells.
5. Transfers RNA labels to ATAC cells by majority vote over top-k transported
RNA neighbors.
6. Writes predicted ATAC labels to disk.

### Output

- `atac_label_moscot.txt`

This file contains the predicted ATAC cell labels indexed by cell barcode and
is saved in the same folder as the corresponding embeddings.

### Notes

- All MOSCOT hyperparameters (`epsilon`, `alpha`, `k_top`) are fixed and
consistent across datasets and methods.
- The script is intended as a **reference implementation** for benchmarking
and is not designed as a general-purpose pipeline.
